	<!DOCTYPE = HTML>
	<html>
		<head>
			<title>
				mlp
			</title>
			<link rel="stylesheet" type="text/css" href="mlp.css">
			<script src="../js.tool.box/iterasures.js" type="text/javascript">
			</script>
			<script src="../js.tool.box/plot2d.js" type="text/javascript">
			</script>
			<script src="../js.tool.box/mlp.js" type="text/javascript">
			</script>
		</head>
		<body>

			<p id='error'>
				error:
			</p>

			<canvas id="cnvs" width="640" height="400" style="border : 1px solid #123456; position:relative; width:100%; height:92%; background-color:#f0f0f0">
	<!--		<canvas id="myCanvas" width="640" height="400" style="border:1px solid #d3d3d3;">-->

				Your browser does not support the HTML5 canvas tag.
			</canvas>

			<script type="text/javascript">

				var
				doc = document.getElementById( "error" ),
				mlp = new MLP ( [ 3, 3, 8 ], 0, 1, 5.2 );

				var
				p = [
					[ 0, 0, 0 ],
					[ 1, 0, 0 ],
					[ 0, 1, 0 ],
					[ 1, 1, 0 ],
					[ 0, 0, 1 ],
					[ 1, 0, 1 ],
					[ 0, 1, 1 ],
					[ 1, 1, 1 ]
				],
				t = [
					[ 1, 0, 0, 0, 0, 0, 0, 0 ],
					[ 0, 1, 0, 0, 0, 0, 0, 0 ],
					[ 0, 0, 1, 0, 0, 0, 0, 0 ],
					[ 0, 0, 0, 1, 0, 0, 0, 0 ],
					[ 0, 0, 0, 0, 1, 0, 0, 0 ],
					[ 0, 0, 0, 0, 0, 1, 0, 0 ],
					[ 0, 0, 0, 0, 0, 0, 1, 0 ],
					[ 0, 0, 0, 0, 0, 0, 0, 1 ]
				],
				len      = 100,
				curPatId = 0,
				err		 = arr ( 8, cst ( 0 ) ),
				cue_err  = arr ( 8, cst ( arr ( len, cst ( 0 ) ) ) ),
				cue_x    = arr ( 8, cst ( arr ( len, cst ( 0 ) ) ) ),
				cnvs     = document.getElementById ( "cnvs" ),
				cntxt    = cnvs.getContext ( "2d" ),
				col      = [ "#000000", "#0000ff", "#00ff00", "#00ffff", "#ff0000", "#ff00ff",  "#ffff00",  "#ffffff", "black" ],
				loop     = 0,
				paintErr = function ( ) {

					var
					e_ = mlp.rms ( );

					err[ curPatId ] = e_;

					plot = new Plot2d ( "cnvs" );

					for ( var i = 0; i < 8; ++i ) {

						for ( var j = 0; j < len - 1; ++ j ) {

							cue_x[ i ][ j ] = cue_x[ i ][ j + 1 ];
							cue_err[ i ][ j ] = cue_err[ i ][ j + 1 ];
						}

						cue_x[ i ][ len - 1 ] = loop;
					}

					cue_err[ curPatId ][ len - 1 ] = e_;

					for ( var i = 0; i < 8; ++ i ) {

						plot.vcol ( col[ i ] );
						plot.addYX ( cue_err[ i ], cue_x[ i ] );
					}

					doc.innerHTML = ( "Loop: " + loop + "\tRMS: " + e_ );

					plot.grid ( );
					plot.draw ( );
				},
				doLoops = function ( pI_loops ) {

					for ( var l = 0; l < pI_loops; ++ l ) {

						curPatId = parseInt( 8 * Math.random ( ) );

						var
						r_   = Math.random ( ),
						absE = cum ( rAdd, err ),
						prob = rel ( rDiv, err, arr ( err.length, cst ( absE ) ) ),
						p_   = prob[ curPatId ];

						while ( p_ <= r_ && curPatId < 7 ) {

							p_ += prob[ ++ curPatId ];
						}

						mlp.remember( p[ curPatId ] );
						mlp.teach ( t[ curPatId ] );
					}

					loop += pI_loops;
				},
				tm = new Date ( ).getTime ( ),
				timer = function ( ) {

					requestAnimationFrame( timer );

					var
					nw = ( new Date ( ).getTime ( ) - tm );

					if ( 10000 / 60 < nw ) {

						paintErr ( );

						doLoops ( 1000 );

						tm = new Date ( ).getTime ( );
					}
				};

				timer ( );

			</script>

		</body>
	</html>
